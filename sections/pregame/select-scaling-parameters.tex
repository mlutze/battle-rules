\subsection{Select scaling parameters}


The parameters are used to scale the battle to an appropriate size.
They control the damage done by attacks,
the health of units in the battle,
and the scaling of the board size,
in turn affecting the duration of the battle.
The parameters are summarized below.

\begin{itemize}
    \item $A$ (attack scalar) -- roughly indicates how much damage is required to reduce a unit's health by one point
    \item $H$ (health scalar) -- indicates how many points of creature health (without armor) are equal to one point of unit health
    \item $F$ (fraction attacking) -- the proportion of a unit that is attacking on a turn
    \item $G$ (grid size) -- the number of feet represented by the edge of a grid tile
\end{itemize}

Provided they are ascribed valid values,
the invariant is maintained that if army $A$ is objectively stronger than army $B$,
the resulting statistics of army $A$ will be at least as strong as those of army $B$.

\section{Choosing Parameters}\label{sec:params}

\begin{table}
\begin{tabular}{c|c|c|c|c|c}
        &   $n$             &   $t_a$           &   $m$             &   $e$             &   $s$             \\
    \hline
    $A$ &   -               &   $\downarrow$    &   $\uparrow$      &   -               &   $\downarrow$    \\
    $H$ &   $\downarrow$    &   $\uparrow$      &   $\downarrow$    &   -               &   $\uparrow$      \\
    $P$ &   *               &   *               &   -               &   -               &   -               \\
    $S$ &   -               &   $\uparrow$      &   -               &   -               &   -               \\
    $F$ &   -               &   -               &   $\downarrow$    &   -               &   $\downarrow$    \\
    $G$ &   -               &   -               &   $\downarrow$    &   $\downarrow$    &   -
\end{tabular}
\end{table}

\begin{table}
\begin{tabular}{c|c|c|c|c|c|c}
            &   $A$             &   $H$             &   $P$ &   $S$ &   $F$ &   $G$ \\
    \hline
    $n_*$   &   -               &   $\downarrow$    &   -   &   -   &   -   &   -   \\
    $d_*$   &   $\downarrow$    &   -               &   -   &   -   &   -   &   -
\end{tabular}
\end{table}

\begin{table}
\begin{tabular}{c|c|c|c|c|c}
            &   $n$             &   $t_a$           &   $m$             &   $e$             &   $s$             \\
    \hline
    $n_*$   &   $\uparrow$      &   $\downarrow$    &   $\uparrow$      &   -               &   $\downarrow$    \\
    $d_*$   &   -               &   $\uparrow$      &   $\downarrow$    &   -               &   $\uparrow$      \\
\end{tabular}
\end{table}

Parameter selection is important for smooth and interesting gameplay.
One should consider a number of options when deciding on parameter values.

\subsection{The $P$ Parameter}

The $P$ parameter is the most nebulous of the parameters,
as it doesn't correspond to any real statistic.
The current recommendation is to assign it a value of 2.

\subsection{The $H$ Parameter}

The $H$ parameter represents the health of the units,
and directly scales their number of dice, which act as hitpoints.

\subsubsection{Minimum Dice}

In order to ensure that each unit has a reasonable number of dice,
it may be desirable to choose a value $n_*$
such that every unit has at least $n_*$ dice.

The unit with the least dice is that with the lowest health,
calculated according to the health factor:
\[
    h u r^P
\]
From the statistics of the least-health unit, the formula for $H$
can easily be derived using the normal $n$ formula.
\[
    n_* =
        \frac
            {h u r^P}
            {10^P H}
\]
can be rearranged to
\[
    H =
        \frac
            {h u r^P}
            {10^P n_*}
\]

\todo[inline]{example}

\subsection{The $A$ Parameter}

The $A$ parameter defines a ``standard'' amount of damage:
the amount of damage a unit must do to reduce an opponent's dice by one.
A low $A$ value can speed up combat,
and may reduce the relative strength of the strongest units;
as hit chance cannot exceed 100\%.
A high $A$ value can slow down combat,
and may leave the weakest units with no chance to hit.
(Units that cannot hit are referred to as \emph{fodder}.)

\subsubsection{Median Damage}

Having already determined the $H$ parameter and
therefore the number of dice of each unit,
may be useful to select $A$ by the average damage of an attack.\footnote{
    Note that the maximum and minimum damage of an attack
    are already determined by the number of dice of each unit,
    as the most damage on unit can do is equal to its health.
}

We begin by identifying the median attack,
according to the attack-defend ratio calculated by the following formula.
\[
    \frac
        {n d_a (10 + b_a)^P}
        {h r^P}
\]
With the median attack in hand,
we can use the unit's statistics to derive an appropriate $A$ value
such that this attack is most likely to deal our target average damage, $d_*$.
Recall the previously introduced hit chance formula:
\[
    p = \frac
        {d_a (10 + b_a)^P H}
        {h r^P A}
\]
We want to choose a value $A$ such that $d_* = n p$:
\[
    d_* = \frac
        {n d_a (10 + b_a)^P, H}
        {h r^P A}
\]
We rearrange to get the formula:
\[
    A = \frac
        {n d_a (10 + b_a)^P, H}
        {h r^P d_*}
\]

\todo[inline]{pick A by min target $t$}

\subsection{The $S$ Parameter}
The $S$ parameter is generally set to 20 in this document,
as it balances granularity and simplicity,
and is familiar to d20 system users.
It is possible, however, that greater granularity is needed.
This might arise in cases where,
after calculating an appropriate $A$ value,
one or more battle participants needs only to roll 1 to hit,
(i.e., will always hit),
or otherwise if participants whose strength ought to be different
identical statistics.

These issues may be addressed by increasing the $S$ parameter to 100,
for example.
However, they may instead point to an issue that some unit
is so weak as to be in ineffectual and might be disregarded for the battle.

\subsection{The $F$ Parameter}

\subsubsection{Scaling Time}

\[
    F = \sqrt{u_\rightarrow}
\]
We can calculate the time of round via the $F$ parameter,
which represents the fraction of a unit that is actually attacking on a given turn.
\[
    s = \frac
        {3 A}
        {H F}
\]
\todo[inline]{can calculate via assuming only periphery will attack, etc.}
\todo[inline]{explain why div by 2}
\todo[inline]{explain why mul by 3 (6 / 2)}
\todo[inline]{explain s}

\subsection{The $G$ Parameter}

\subsubsection{Scaling Space}

Each unit takes up space according to its members:
a unit of 20 medium creatures takes a total of 500 square feet (25 square feet per creature).
When playing on a grid,
some rounding must be done to ensure that each unit conforms to the grid;
i.e., that each unit's tile size is a square number.

We scale the size of units relative to the grid
according to parameter $G$,
which indicates the length of the edge of a grid tile.
A unit's edge length is calculated by the following:
\[
    e = \frac
        {\sqrt{c^2 u}}
        {G}
\]

\subsubsection{Scaling Speed}
The marching speed $m$ of a unit is determined
by the scaling of time and space
as applied to the creature's speed.
We begin with the creature's speed and divide by 6
to find the distance traveled per second.
\[
    \frac
        {p}
        {6}
\]
We multiply by the number of seconds per round:
\[
    \frac
        {p}
        {6}
    \left(
        \frac
            {A}
            {2 H F}
    \right)
\]
And finally we divide by the number of feet per tile,
simplifying to
\[
    m = \frac
        {p A}
        {12 H F G}
\]

\subsubsection{Minimum Unit Size}

One may select $G$ in such a way that the physically smallest unit
occupies exactly one square.

First, the smallest unit must be found,
which is the unit for which the unscaled size value is smallest:
\[
    \sqrt{c^2 u}
\]
We then select $G$ such that $e = 1$;
i.e., we solve:
\[
    G = \frac
            {\sqrt{c^2 u}}
            {1}
\]
which is easily simplified to
\[
    G = \sqrt{c^2 u}
\]

\subsubsection{Minimum Unit Speed}

One may selection $G$ in such a way that the slowest unit moves one square per turn.

First, the slowest unit must be found,
which is the unit whose creature speed value $p$ is least.

We rearrange the formula for $m$ in order to find the $G$ value:
\[
    G = \frac
            {p A}
            {12 H F m}
\]
Setting $m$ to 1 tile, we have:
\[
    G = \frac
            {p A}
            {12 H F}
\]

\subsubsection{Attack Range}

With the size of the grid established, the attack range for the units may be established.
This is done simply by taking the long range for an attack,
dividing by the grid size,
and rounding up.

\[
    x_a = \left\lceil\frac
        {l_a}
        {G}
        \right\rceil
\]

\todo[inline]{Mix the two: take $G = min(G_1, G_2)$}